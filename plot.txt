library(ggplot2)

# Filter the result_table based on p-value threshold
significant_vars <- result_table[result_table$P_Value < 0.05, ]

# Define custom X-axis labels
custom_labels <- c("Poly-N-acetylglucosamine (K19428)", "Hyaluronic acid (K13810)", "Poly-N-acetylglucosamine (K19430)","Psl (K21000)", "Hyaluronic acid (K12537)","Poly-N-acetylglucosamine (K11937)", "Colanic Acid(K13684)","S-7 (K13328)")  # Add the desired labels

# Create scatter plots for significant variables
scatter_plots <- lapply(seq_len(nrow(significant_vars)), function(i) {
  var_name <- as.character(significant_vars[i, "Variable"])
  cor_value <- significant_vars[i, "Correlation"]
  p_value <- significant_vars[i, "P_Value"]
  
  # Create scatter plot with regression line
  p <- ggplot(eps, aes_string(x = var_name, y = "Brucite")) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE, color = "red") +
    labs(title = sprintf("Correlation: %.2f, p-value: %.4f", cor_value, p_value), 
         x = custom_labels[i], y = "Brucite") +
    xlab(custom_labels[i]) +  # Change the x-axis label
    theme_minimal()
  
  p
})

# Display scatter plots
gridExtra::grid.arrange(grobs = scatter_plots, ncol = 2)